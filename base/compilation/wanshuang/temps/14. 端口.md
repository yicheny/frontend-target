[TOC]

和CPU通过总线相连的芯片，除了各种存储器之外，还有以下三种：
1. 各种接口卡（显卡、网卡等）
2. 主板上的接口芯片，CPU通过它对部分外设进行控制
3. 其他芯片，用于存储相关系统信息，或进行输入输出处理

在这些芯片中，都有一组可以由CPU控制的寄存器，这些寄存器在物理上可能处于不同的芯片上，但是它们有两点相同：
1. 都和CPU相连【实际上是与其所在的芯片进行相连】
2. CPU对它们进行读或写的时候，都通过控制总线向它们所在的芯片端口发出读写命令

CPU将这些寄存器都当作端口，对它们进行统一编址，从而建立了一个统一的端口地址空间，每一个端口在地址空间中都有一个地址。

CPU可以直接读取三个地方的数据：
1. CPU内部寄存器
2. 内存单元
3. 端口

# 端口的读写
1. 在访问端口的时候，CPU通过端口地址定位端口
2. 因为端口所在的芯片通过CPU和总线相连
3. 所以，端口地址和内存地址一样，通过地址总线来传送
4. PC系统中，CPU最多可以定位64K个不同的端口，则端口范围是0~65535

1. 对端口的读写不能使用mov、pop、push等指令
2. 端口的读写指令只有两个：in、out

CPU执行内存访问指令和端口访问指令时，总线上的信息：
1. 访问内存:
```
mov ax,ds:[8] ;假设(ds)=0
```
执行时与总线相关的操作：
1)  CPU通过地址线将地址信息`8`发出
2)  CPU通过控制线发出**内存读**命令，选中存储器芯片，并通知它，要从中读取数据
3)  存储器将8号单元的数据通过数据线传送给CPU

2. 访问端口
```
in al,60h ;从60h号端口读入一个字节
```
执行时与总线相关的操作：
1) CPU通过地址线将地址信息`60h`发出
2) CPU通过控制线发出**端口读**命令，选中端口所在的芯片，并通知它，要从中读取数据
3) `60h`端口所在的芯片将数据通过数据线传送给CPU

在`in`和`out`指令中，只能使用`ax`或`al`来存放从端口中读入的数据或需要发送到端口的数据，访问`8`位端口时使用`al`，访问`16`位端口时使用`ax`

# `CMOS RAM`芯片
PC机中，有一个`CMOS RAM`芯片，通常简称为`CMOS`芯片，特征如下：
1. 包含一个实时钟
2. 包含一个有128个存储单元的RAM存储器
3. 该芯片靠电池供电。所以关机后实时钟也会工作，RAM信息不会因此丢失
4. RAM中，内部实时钟占用`0~0dh`单元来存储时间信息
5. 其余单元用于保存系统配置信息，供系统启动BIOS时使用【读写】
6. `CMOS`芯片有两个端口，为`70h`和`71h`，CPU通过这两个端口对`CMOS`芯片进行读写
7. `70h`是地址端口，用于存放要访问的`CMOS RAM`单元的地址
8. `71h`是数据端口，存放从选定的`CMOS RAM`单元中读取的数据，或要写入其中的数据

CPU对`CMOS`的读写分为两步进行，举例，读取`CMOS`的`2`号单元数据：
- 将数据2送入端口`70h`
- 从端口`71h`读取`2`号单元内容

# `shl`、`shr`指令
shl、shr是逻辑移位指令

shl是逻辑左移指令的，它的功能为：
1. 将一个寄存器或内存单元的数据向左移位
2. 将**最后移出的一位**写入CF中
3. 最低位用0补充

指令：
```
mov al,01001000b
shl al,1 ;将al数据左移一位

;结果
(al)=10010000b
CF=0
```

如果移动位数大于1，则必须将其放到寄存器`cl`中，如：
```
mov al,01001000b
mov cl,2
shl al,cl

;结果
(al)=00100000b
CF=1
```
从逻辑上考虑，左移相当于`x=x*2`

# `CMOS RAM`中存储的时间信息
存放着6个信息，每个信息1字节，信息地址如下：
1. 秒：0
2. 分：2
3. 时：4
4. 日：7
5. 月：8
6. 年：9

这些数字以`BCD`码形式保存，`BCD`码就是以二进制信息表示十进制。

```
BCD码：0000 0001 0010 0011 0100 0101 0110 0111 1000 10001
十进制： 0    1    2    3    4    5    6    7    8    9    
```

只需要4bit就能表示1个`BCD`码，因此，1个字节可以保存两个`BCD`

比如说：`BCD`码`00010100`就是十进制`14`