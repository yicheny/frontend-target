
局域网路由器将网络包通过网关发送后并没有直接进入互联网，而是先发送到接入网，然后经接入网进入互联网。

这里我们得说一下互联网和局域网得不同。

从抽象的角度考虑，互联网的原理和局域网是相同，同样是通过路由器和ip进行转发。

不过也有一些不同，其一是距离，局域网距离很近，所以传输线很短就可以满足需要，但是互联网不行，互联网距离相差很远，比如说我可能需要将数据从中国传到美国，那么局域网短短几十米的传输线根本就满足不了需要。

其二是路由器数量，局域网内路由器数量相对可控，而互联网中存在数十万台路由器，而且随着时间日益增长中，所以互联网中的路由表维护策略和局域网策略是不同的，至少它不能手动维护是不是？另外虽然局域网也有自动维护路由表的策略，不过互联网的维护策略和局域网策略是不同的。【为什么？】

现在回到接入网，接入网有很多类型，比如电话线、ADSL、FTTH这些，有些公司可能会使用专线，这里我介绍两种典型接入网：ADSL、FTTH

# ADSL
ADSL，即不对称数字用户线，是一种用架设在电线杆上的金属线进行高速通信的技术，因为它的上行速度（用户到互联网）和下行速度（互联网到用户）的速度不一致，故此得名。

我们看一下ADSL做了什么。

局域网路由添加IP、MAC头部后将包发出，ADSL路由器接收，首先取出ip包，接下来和局域网路由器操作不同，ADSL路由器会添加MAC、POPoE、PPP头部，然后将其发送给ADSL Modem

Modem即调制解调器，它会接收包，然后将其转换为ATM信元，然后利用调制技术将其转换为电信号发出。

这里得说明下，ATM，即异步传输模式，是基于传统电话线开发出的一种通信技术，是以信元为单元进行传输的，信元是头部5字节，数据48字节的一种包，和TCP/IP技术将应用程序拆分到不同包中有相似之处。

Modem会将数字信号拆分为ATM信号，之所以需要这么做，是因为在设计ADSL技术时，当时业界普遍看好ATM技术，为此投入大量资源，使用ATM信元传输是为了复用资源，不然就很浪费。

实际上，拆分为ATM信号不是必须的，有些ADSL运营商并不会将其拆分为ATM信元。

接下来说明下Modem的调制技术，在此之前我们都是以方形信号进行传输的，这里有两个问题：
1. 方形波形容易失真，距离越长错误率越高
2. 方形波形覆盖了低频到高频频段，信号频率越高，越是容易收到干扰，所以方形波形很难控制噪声干扰

针对方形波形的问题，Modem使用了圆滑波形（正弦波）合成表示0、1信息的技术，这一技术我们称之为调制。

关于调制，不仅解决了噪声干扰的问题，还提升了传输效率。

调制有两种方式：振幅调制和相位调制，利用这两种技术可以有效提升传输效率。

以振幅来说，假设默认只有两种振幅，0、1，那么只能表示两种信息。

如果我们改变振幅，允许表示4种振幅，那么可以表示4种信息，即一次就可以表示2bit信息。

再说下相位，相位就是弦波角度，假如我们以0、180来切分，只能表示两种信息。

如果改变切分规则，以0、90、180、270来切分，我们就可以表示4种信息，同样可以一次表示2bit信息。

将两者结合，如果振幅可以表示4种信息，相位也可以表示4种信息，那么4*4=16，一次可以传输4bit信息。

就是这样，理论上再多一些也可以，不过考虑划分太多测量容易出错，所以也不适宜划分过多。

不过即使如此，仅凭

## 流程概览
1. 内网路由器
   1. 添加IP头部
   2. 添加MAC头部并发送
2. 接入网
   1. 接受包
   2. 取出IP包
   3. 添加MAC、PPPoE、PPP头部
3. ADSL Modem
   1. 接收包
   2. 拆分为ATM信元
   3. 转换为电信号并发送 
4. DSLAM
   1. 接收电信号
   2. 转换为ATM信元并发送
5. BAS
   1. 接收ATM信元
   2. 还原为网络包
   3. 取出PPP包
   4. 添加隧道头部并发送（如L2TP隧道）
6. 路由器（隧道专用）
   1. 接收隧道包
   2. 取出IP包
   3. 发送到互联网内部

# 名词
- **ADSL**：Asymmetric Digital Subscriber Line，不对称数字用户线。它是一种
利用架设在电线杆上的金属电话线来进行高速通信的技术，它的上行方向
（用户到互联网）和下行方向（互联网到用户）的通信速率是不对称的。
- **FTTH**：Fiber To The Home，光纤到户。指的是将光纤接入家庭的意思、
- **ATM**：Asynchronous Transfer Mode，异步传输。它是在以电话线为载体的 传统电话技术基础上扩展出来的一种通信方式。它的数据传输是以“信元”为单位来进行的，这和以包为单位传输数据的 TCP/IP 很像，但这种方式并不适用于计算机通信。