[TOC]

早期设计网页的时候，页面是以适配的屏幕大小进行设计的，而后来随着时代发展，用户的屏幕大小随之多元化，出现了页面空间使用不足、多余的滚动条、过长的行等问题。

因此，新时代的网页设计需要考虑兼容不同尺寸的屏幕，进行布局和样式上的调整，这就是响应式布局

# 早期布局
说一下早期液式布局和固定宽度两种模式及其所带来的问题

## 液式布局
液式布局可以认为是将宽度设定成和屏幕保持一致，这种布局的问题在于如果屏幕宽度太小，可阅读信息会挤成一团；而如果屏幕宽度很大，一行又会很长。
·                                                        
## 固定宽度
固定宽度就是为文档流限定在固定宽度内容，问题在于如果屏幕宽度很小，会出现多余滚动条；而如果屏幕宽度很大，会出现很多空余空间。

# 响应式设计
早在2004年，Cameron Adams就在文章《Resolution dependent layout》提出了一种根据分辨率进行动态布局的方式，这种动态布局是通过Javascript探测屏幕分辨率载入不同的css实现的

**响应式设计**这个词是Ethan Marcotte在2010年首次提出的，他将其描述为三种技术的混合使用：
1. 液态网格，这个技术在之前已经被Marcotte深入探究过，可以看他的文章[Fuild Grids](https://alistapart.com/article/fluidgrids/)
2. [液态图像](https://unstoppablerobotninja.com/entry/fluid-images/)理念，通过`max-width:100%`这种技术，当图像包含列变得比原始寸尺小的时候，图像会进行缩放，但不会放大。这种技术使得图片正在小屏幕中不会溢出，也使得图像不会在大屏幕中放大以致于画质变得粗糙
3. 媒体查询，媒体查询使以往Cameron Adams提出的有Js实现的布局类型切换，可以只使用Css实现。

关于响应式设计需要理解的最重要一点是响应式设计不是一个单独的技术，它是描述Web设计的一种方式，是一组最佳实践的集合。

在Marcotte最初的探索中，这种设计使用float和媒体查询实现的，而在这篇文章的十年以后，响应式设计已经成为了默认做法。现代的Css布局基本上都是响应式的，而且浏览器内置了更多了特性，使得响应式设计变得更加容易

下面介绍下Marcotte探索时所使用的响应式技术

## 媒体查询
媒体查询可以说是响应式设计中最重要的一个技术，最开始它是2004年由Cameron Adams所提出的，使用JS进行实现。

在2009年的时候，媒体查询已经成为Css的第三级别规范，这意味着它已经准备好在浏览器中大规模被支持了，也这是此时，响应式设计被媒体查询所带动而逐渐普遍起来。

媒体查询允许开发者运行一系列测试，比如说用户的屏幕是否大于某个宽度或分辨率，以便将Css选择性的适应用户的需要应用在样式化页面上。

下面是一个媒体查询的用例：
```css
@media screen and (min-width:800px){
    .container{
        margin:1em 2em;
    }
}
```
我们可以在样式表里添加多个媒体查询，以调整页面或部分页面以达到适应各屏幕的最佳效果。

媒体查询，以及样式改变时的点，被称作断点（breakpoints）

使用媒体查询的一种通用方式是，为窄屏设备（比如移动设备）创建一个简单的单栏布局，然而检查大一些的屏幕，当宽度满足需求时，采用多栏布局，这种被描述为**移动优先设计**

想要了解更多媒体查询的信息，可以阅读[MDN-媒体查询](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Media_Queries)

## 灵活网格
实现响应式站点不只是在断点之间改变布局，另一个非常重要的技术是灵活网格。

如果没有灵活网格，让开发者去适配每种可能的设备尺寸，然后为其建立一个精确到像素级的适配布局，这是一个荒诞的想法。首先现存设备非常之多，其尺寸也是五花八门，数十种数百种尺寸都不止，另一方面，浏览器的尺寸是可以随意调节的，这一点使得尺寸的可能性基本不可预测，人们可以随意调整浏览器阅读。

因此灵活网格在响应式设计中几乎是必须的一个技术，我们只需要少量的添加断点，在内容布局出现问题时（比如屏幕过大难以阅读，空白空间过多等）

早期进行响应式设计时，开发者唯一可选择的布局实现是`float`。

灵活浮动布局是这样的：让每列都一个作为宽度的百分数，并且保证整个布局宽度不会超过100%。

在Marcotte的探索中，他详细描述了一种布局的法则，通过使用像素将其转换为百分数进行布局设计：`target / context = result`

比如我们预期菜单栏的尺寸是60px，而容器宽度是960，那么菜单栏的宽度应该设置为`60 / 960 = 0.625 = 6.25%`

这种布局方式在非常多的web网站中所使用，随着Flex和Grid普及将被逐渐淘汰，但是我们还是极有可能在一些老旧或者说传统网站中遇到，因此需要理解这种布局方式。

也许我们不需要在开发中使用浮动进行布局，但是理解和掌握浮动布局依旧是必要的。

# 现代布局技术
多栏布局、Flex、Grid都是灵活网格，它们默认都是响应式的，它们都假设开发者想要开发一个可伸缩的灵活网格，因而使用上也给了开发者这么做的简单做法。

## 多栏布局
这几种布局中最古老的，主要使用方式是`column-count`、`column-width`都是动态分配宽度的

## Flex
主要是通过`flex-grow`、`flex-shrink`控制弹性的

## Grid
主要通过`fr`单位动态控制尺寸。

> 实际上在控制动态尺寸上，Grid要更加简单，因为Grid是在容器上直接控制的，而Flex则是在子项上控制的（虽然可以通过选择器一次选择所有子类）

## 响应式图片
最简单的处理响应式图像的方式是Marcotte在2010年关于响应式设计的文章上所描述的那样做。

基本来说，我们可以使用一张有着所需最大尺寸的图像，然后缩放它。这种做法在现在依旧被使用着。

我们在很多样式表中都可以找到下面这种写法：
```css
img {
    max-with:100%
}
```
这种做法有着明显的弊端，图像可能显示的比它原始尺寸小的多，以至于浪费带宽。

这种做法涉及到两个问题：
1. 浪费带宽
2. 可能我们希望在移动端小屏幕上展示的图片是不同图片
   1. 移动端和PC端可能所需要的图片比例不同，因为移动端和PC的宽高比是有很大不同的。
   2. 移动端屏幕更小，我们可能希望在小屏幕时换上一张更容易理解的图片，而不仅仅是缩放图像。

这个问题，在HTML中也有被考虑到，响应式图像，最佳方式是使用`<picture>`和`<img>`的`srcset`和`sizes`特性以解决刚刚提到的两个问题，我们可以提供多个尺寸的图像，浏览器将会根据设备选择最合适的图像，以确保用户可以在设备上得到最佳的图像体验。

响应式图像技术按流程之前已经学过了，详细见[MDN-响应式图像](https://developer.mozilla.org/zh-CN/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images)

## 响应式排版
这是Marcotte在探索响应式设计时没有考虑到的一点。

事实上，根据屏幕的尺寸，调整字体的大小也是很重要的一环，否则在小屏幕显示大字体或者在大屏幕显示小字体都是糟糕的设计。

一般的做法是使用媒体查询进行调整，比如：
```css
h1 {
  font-size: 2rem;
}

@media (min-width: 1200px) {
  h1 {
    font-size: 4rem;
  }
} 
```
可以看到我们这里使用了`rem`单位，如果我们将字体大小都使用`rem`，调整字体大小会方便很多，断点时只需要调整根元素大小。

### 使用视口单位实现响应式排版
另一个做法是使用视口单位`vw`实现响应式排版，`1vw`等同于视口宽度的百分之一，如果使用`vw`设定字体大小，字体大小将随视口大小改变。

然而使用`vw`设置字体时，开发者难以全局性的控制文本缩放，所以**永远不要只用`viewport`单位设定文本**

有一个办法，可以既让文本随页面自动改变，也可以让开发者全局控制，简单的说就是使用`calc()`，这个方法可以结合`vw`和`rem`。例如：
```css
h1 {
    font-size:calc(1.5rem + 3vw);
}
```

## 视口元标签`<meta>`
在响应式的`html`源码中，我们通常可以看到这么一行代码：
```html
<meta name="viewport" content="width=device-width,initial-scale=1">
```
这个标签的意义是告诉移动端浏览器，应该将视口宽度设定为设备的宽度，且初始缩放比为`1`

为什么会需要这个`meta`标签，起因是iPhone发布以后，人们开始在手机屏幕上浏览网页，而大多数网站没有对移动端做优化，移动端浏览器会将视口宽度设为960像素，并以这个宽度渲染页面，结果渲染出来的页面是缩放版本，对于用户来说，这是糟糕的。

不只是`iPhone`浏览器，其他移动端浏览器（比如安卓上的浏览器）也是这么做的。

因此，如果不使用`meta`标签，那么媒体查询得到的结果并不是设备的真实宽度，我们的`css`就不会按预期工作。

所以，我们在文档头部应该总是包含`meta`标签。

`meta`需要注意的几个属性：
- `initial-scale`：页面的初始缩放比例，一般为1
- `width` 用于为视口设定宽度，一般是`device-width`
- `height` 用于为视口设定高度
- `minimum-scale` 设定最小缩放级别
- `maximum-scale` 设定最大缩放级别
- `user-scalable` 用户是否可以缩放，设置为`no`用户无法缩放，这么做会造成访问性问题，需要注意。

> `@viewport`这个css规则是设计用于替换`meta`标签的，但是浏览器支持太差，原本是IE和Edge中引入的，但是Edge换成`Chromium`内核后，就不再被`Edge`支持了。另外这个特性已经从Web标准中删除了，即使现在有一些浏览器支持这个特性，在后续版本中也可能被废弃，所以不要使用该特性。

