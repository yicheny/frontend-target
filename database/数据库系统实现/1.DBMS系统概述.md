[TOC]

# 什么是数据库？
简单的说就是数据集合，这些数据会**持久**保存。

## 发展
1. 最早的商用数据库出现在20世纪60年代，是从文件系统演变而来，对于现代数据库应当满足的5大特性，只满足一条，就是可以持久保存数据。以我们现在的眼光看来，它缺乏许多数据库重要的特性，比如说高效的查询速度，没有可以简单操作的语言，对同时修改没有保障等等
2. 20世纪70年代，弗兰克-埃德加-科德发布了自己的论文，这个关系型数据库的开山祖师首次提出关系性数据库的概念，认为用户不需要关注数据的存储结构，数据库应当提供简单易懂的操作方式，这对数据库领域产生了革命性的变化
3. 变化
   1. 越变越小：指软件本身，一开始只能在大型计算机上使用，现在个人计算机也能使用了
   2. 越变越大：指存储的数据，从普通的文本，到图片、电影、网络数据流等等
   3. 信息集成：指现在数据可能分布在同个公司的不同服务器上，需要集成数据

# 数据库系统概述   
来源：
1. 普通用户和应用程序：查询和修改数据
2. DBA（数据库管理员）：创建数据库模式和结构的一个或一组人

执行流程见：

![数据库管理系统成分](https://pic.imgdb.cn/item/62c3ad2a5be16ec74a380435.jpg)

## DDL
1. 模式的创建修改都是由定义的DDL命令处理的
2. DBA需要特殊权限才能执行模式修改
   1. 进行模式修改，会编写对应的DDL命令，然后交给DDL程序处理
   2. DDL程序处理之后传给执行引擎
   3. 执行引擎经过 索引/文件/记录管理器 去改变元数据【数据库的模式信息】

## DML
DML用于
1. 修改数据库数据【如果是修改命令】
2. 提取数据库数据【如果是查询命令】

## 查询响应
1. **查询编译器**对查询进行分析和优化
2. 优化后的查询命令被传给**执行引擎**
3. 执行引擎向**资源管理器**发出一系列对小的数据单元（通常是`tuple`）的请求
   - 资源管理器有着数据文件、记录文件数据格式和大小的文件、支持快速查找的索引文件
4. 查找数据的请求被传送给**缓冲区管理器**，它负责将磁盘中的一些数据取到主存的缓冲区中，传输单位通常是页
5. 缓冲区管理器和**存储管理器**进行通信，以从磁盘获取数据。存储管理器可能使用操作系统命令，但通常情况下，DBMS直接发送命令给**磁盘控制器**

## 事务处理
事务就是组成一组的查询或修改命令。

ACID：
- A 原子性
- C 统一性
- I 孤立性
- D 持久性

事务处理器分成以下两部分：
1. **并发控制管理器**，负责A、I
2. **日志和恢复管理器**，负责D

## 存储控制器
数据库数据通常保存在辅助存储器中，数据必须在主存中，才能进行处理，存储管理器的作用就是控制数据在磁盘和主存之间的移动。

简单的数据库系统里，存储管理器和一般文件系统区别不大。不过更多情况下，为了提高效率，存储管理器会做很多处理，比如说追踪文件在磁盘上的位置，加速获取缓冲区管理器所需要的文件的磁盘号。

缓冲区管理器负责将分配的内存空间分割成缓冲区，然后将磁盘数据放到缓冲区中，所有需要从磁盘中换取的信息都要经过缓冲区，要么直接与缓冲区交互，要么通过执行引擎与缓冲区交互。

交互的数据类型包括：
1. 数据：数据库自身内容
2. 元数据：描述数据库的结构及约束的数据库模式
3. 日志记录：记录命令，以支持数据库持久性
4. 统计信息：数据库的关系及大小、取值等
5. 索引：支持对数据进行高效存储的数据结构

# 名词
- `DBA`：`database administrator` 数据库管理员
- `DDL`：数据定义语言
- `DML`：数据操作语言