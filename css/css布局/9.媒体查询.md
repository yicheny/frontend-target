[TOC]

媒体查询是响应式设计的重要组成部分，本篇介绍媒体查询的用法。

# 基础
媒体查询语法规则的形式一般是这样的：
```css
@media media-type and (media-feature-rule) {
  /* CSS rules go here */
}
```

媒体查询语法由以下部分组成：
- 一个媒体类型，告诉浏览器这段代码是用在什么类型的媒体上的（比如说印刷品或屏幕）
- 一个媒体表达式，是一个被包含的Css生效所需要的规则或测试
- 一组Css规则，会在测试通过且媒体类型正确的时候应用

## 媒体类型
可以指定的媒体类型有：
- `all` 适用于所有设备。
- `print` 适用于在打印预览模式下在屏幕上查看的分页材料和文档。
- `screen` 用于屏幕。
- `speech` 用于语音合成器。

以下规则会在页面被打印时生效，而在浏览器载入时不生效：
```css
@media print {
    body {
        font-size: 12pt;
    }
}
```

> 注：媒体类型是可选的，如果没有指定则默认应用于全部媒体类型

详细可见[MDN-媒体查询](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Media_Queries/Using_media_queries)

## 媒体特征规则
在指定类型之后，可以用一条规则指向一种媒体特征。

### 宽高
一般最常探测的特征是视口宽度，比如：
- `min-width` 大于指定值时生效
- `max-width` 小于指定值时生效
- `width` 视口宽度完全相同时生效

用法示例：
```css
@media screen and (max-width: 400px) {
    body {
        color: blue;
    }
}
```

基本上最大和最小宽度对响应式设计都有作用，所以会一起使用，单独使用某一个的情况相对少见。

### 朝向`orientation`
这个特性的支持度也很高，可以使用此特征测试竖放（portrait mode）和横放（landscape mode）模式。

例如：
```css
@media (orientation: landscape) {
    body {
        color: red;
    }
}
```
这个样式会在横放模式下。标准的桌面视图是横放朝向的，这种朝向可以表现出良好的设计，在处于竖放模式的手机或平板上相同的布局和样式可能表现没有那么理想。此时利用朝向侦测，可以针对竖放模式的设备进行布局和样式上的优化。

### 使用指点设备
//...待补充

# 更复杂的媒体查询
我们可能想要将一些媒体查询混合使用，为此CSS提供了一些语法

## 与
使用`and`操作符可以混合使用媒体类型和特征，比如：
```css
@media screen and (min-width: 400px) and (orientation: landscape) {
    body {
        color: blue;
    }
}
```

## 或
使用`,`分隔条件，这一组条件中有任意一个满足其CSS规则就生效，例如：
```css
@media screen and (min-width: 400px), screen and (orientation: landscape) {
    body {
        color: blue;
    }
}
```

## 非
使用`not`操作符可以让整个媒体查询反转，即所有条件都不满足时才生效。例如：
```css
@media not all and (orientation: landscape) {
    body {
        color: blue;
    }
}
```

## 怎么选择断点？
在响应式设计的初期，很多设计者会尝试指向特定屏幕之村进行设计，然而随着现在的设备越来越多样化，这种做法已经不再可行。

更好的方案是圈定一个尺寸范围，在这个范围内进行测试，当页面内容变得混乱时可以添加断点进行调整。

## 响应式设计方案
简单来说有两种方案实现响应式设计：
1. 从最宽的视图开始，逐渐缩小视窗，添加断点
1. 从最小的视图开始，逐渐放大视窗，添加断点，这也被叫做**移动优先**的响应式设计

一般推荐使用移动优先，因为最小视图布局往往相对简单，不需要进行很多设计，而大尺寸的布局相对复杂，需要处理的内容更多。

## 是否真的需要使用媒体查询？
在前一节我们知道媒体查询只是响应式设计中的一部分，我们并非任何时候都需要使用媒体查询。

灵活布局、灵活排版这些技术是可以独立于媒体查询之外的，我们应当尽量减少添加断点。

比如说：
```css
.container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    ...其他样式
}
```
以这段代码为例，我们可以实现一组卡片的排放，一张卡片最小300px，会在一行内尽可能多的进行摆放（剩余空间会动态分配），利用`grid`布局我们可以不需要添加断点实现这个效果。